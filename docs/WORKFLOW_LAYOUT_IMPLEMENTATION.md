# ワークフロー レイアウト改善 実装手順

## 方法1: Pythonスクリプトで自動化（推奨）

### 前提条件
- Python 3.6以上がインストールされていること

### 実行手順

1. **ターミナルで`n8n_workflow`ディレクトリに移動**
   ```bash
   cd n8n_workflow
   ```

2. **スクリプトを実行**
   ```bash
   python update_layout.py
   ```

3. **出力ファイルを確認**
   - 出力ファイル: `コラムテーマ作成と承認ワークフロー（Slack + Web連携）_レイアウト改善.json`
   - このファイルをn8nにインポートして使用

### 実行結果

スクリプトは以下の変更を行います：
- ✅ 7つのブロックにSticky Noteを追加
- ✅ 各ノードのposition座標を調整（横一列を避け、二段以上に配置）
- ✅ 実装ロジック（parameters、connectionsなど）は一切変更しない

## 方法2: 手動編集

Pythonが利用できない場合は、n8nのWeb UIで直接編集してください。

### 手動手順

1. **各ブロックにSticky Noteを追加**
   - n8nのワークフロー編集画面を開く
   - 左側のパネルから「Sticky Note」をドラッグ&ドロップ
   - 各ブロックの左上に配置し、以下の文言を入力：

   - `① Slack/Webからのリクエスト受信`
   - `② AIでコラムテーマ生成（Gemini）`
   - `③ リクエスト情報をスプレッドシートに保存`
   - `④ Slackでテーマ案の承認を依頼`
   - `⑤ ユーザー返信をAIで判定（承認/修正/却下）`
   - `⑥ 承認後：コラム記事生成・投稿・完了通知`
   - `⑦ 却下時：テーマ再生成（最大2回）または中断`

2. **ノード位置を調整**
   - 上段（y: -200）: 入力 → テーマ生成 → データ保存 → 承認要求 → 承認判定
   - 下段右（y: 200）: 記事生成ブロック（承認後）
   - 下段左（y: -100〜-300）: 再生成ブロック（却下・修正時）

## 実行後の確認事項

- ✅ 各ブロックにSticky Noteが追加されているか
- ✅ ノードが横一列に並んでいないか（二段以上になっているか）
- ✅ ワークフローの動作に影響がないか（テスト実行）


