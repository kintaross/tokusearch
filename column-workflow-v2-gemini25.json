{
  "name": "ã‚³ãƒ©ãƒ è‡ªå‹•ç”Ÿæˆï¼†TokuSearchæŠ•ç¨¿ v2.0ï¼ˆGemini 2.5ï¼‰",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "0 9 * * *"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -1200,
        240
      ],
      "id": "schedule-trigger-001",
      "name": "æ¯æ—¥9æ™‚ãƒˆãƒªã‚¬ãƒ¼",
      "notes": "æ¯æ—¥åˆå‰9æ™‚ã«è‡ªå‹•å®Ÿè¡Œï¼ˆCron: 0 9 * * *ï¼‰"
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "read",
        "documentId": {
          "__rl": true,
          "value": "1iz1ApPwoLMMyqeQW_GA0XYM1qU74tzULNVq6vav3g14",
          "mode": "list",
          "cachedResultName": "TokuSearch",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1iz1ApPwoLMMyqeQW_GA0XYM1qU74tzULNVq6vav3g14/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "column_themes",
          "mode": "name"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "used",
              "lookupValue": "FALSE"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -1000,
        240
      ],
      "id": "google-sheets-read-001",
      "name": "æœªä½¿ç”¨ãƒ†ãƒ¼ãƒå–å¾—",
      "notes": "column_themesã‚·ãƒ¼ãƒˆã‹ã‚‰æœªä½¿ç”¨ï¼ˆused=FALSEï¼‰ã®ãƒ†ãƒ¼ãƒã‚’å–å¾—",
      "credentials": {
        "googleApi": {
          "id": "r9kAyVencycJeNjy",
          "name": "Google Service Account account 2"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// å‰ã®ãƒãƒ¼ãƒ‰ã§Google Sheetsã‹ã‚‰å–å¾—ã—ãŸæœªä½¿ç”¨ãƒ†ãƒ¼ãƒ\nconst unusedThemes = $input.all().map(item => item.json);\n\nif (unusedThemes.length === 0) {\n  throw new Error('âŒ å…¨ã¦ã®ãƒ†ãƒ¼ãƒã‚’ä½¿ç”¨æ¸ˆã¿ã§ã™ã€‚column_themesã‚·ãƒ¼ãƒˆã®usedãƒ•ãƒ©ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦ãã ã•ã„ã€‚');\n}\n\n// ãƒ©ãƒ³ãƒ€ãƒ ã«1ä»¶é¸æŠ\nconst randomIndex = Math.floor(Math.random() * unusedThemes.length);\nconst selectedTheme = unusedThemes[randomIndex];\n\nconsole.log(`âœ… é¸æŠã•ã‚ŒãŸãƒ†ãƒ¼ãƒ: ${selectedTheme.theme} (No.${selectedTheme.no}, ãƒ¬ãƒ™ãƒ«: ${selectedTheme.level})`);\n\nreturn [{ json: selectedTheme }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -800,
        240
      ],
      "id": "code-random-select-001",
      "name": "ãƒ©ãƒ³ãƒ€ãƒ ãƒ†ãƒ¼ãƒé¸æŠ",
      "notes": "æœªä½¿ç”¨ãƒ†ãƒ¼ãƒã‹ã‚‰1ä»¶ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«é¸æŠ"
    },
    {
      "parameters": {
        "jsCode": "const theme = $json.theme;\nconst level = $json.level;\nconst no = $json.no;\n\nconst prompt = `\nã€ã‚·ã‚¹ãƒ†ãƒ æŒ‡ç¤ºã€‘\nã‚ãªãŸã¯ãƒã‚¤æ´»ãƒ»ç¯€ç´„ãƒ¡ãƒ‡ã‚£ã‚¢ã€ŒTokuSearchã€ã®è¨˜äº‹ãƒ©ã‚¤ã‚¿ãƒ¼ã§ã™ã€‚\nä»¥ä¸‹ã®æƒ…å ±ã‹ã‚‰è¨˜äº‹ã‚’ç”Ÿæˆã—ã€JSONå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚\n\nã€å…¥åŠ›æƒ…å ±ã€‘\n- ãƒ¬ãƒ™ãƒ«: ${level}\n- ãƒ†ãƒ¼ãƒ: ${theme}\n\nã€å‡ºåŠ›å½¢å¼ï¼ˆå¿…ãšã“ã®JSONå½¢å¼ã§ï¼‰ã€‘\n{\n  \"title\": \"è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆé­…åŠ›çš„ã§å…·ä½“çš„ã«ã€30-50æ–‡å­—ï¼‰\",\n  \"content_markdown\": \"## å°å…¥\\\\n\\\\næœ¬æ–‡...\\\\n\\\\n## åŸºæœ¬ã®è€ƒãˆæ–¹\\\\n\\\\n...\",\n  \"description\": \"SEOç”¨æ¦‚è¦ï¼ˆ50-160æ–‡å­—ï¼‰\",\n  \"category\": \"ãƒã‚¤ãƒ³ãƒˆæ´»ç”¨è¡“\",\n  \"tags\": \"æ¥½å¤©ãƒã‚¤ãƒ³ãƒˆ, è²¯ã‚æ–¹, ãƒã‚¤æ´»\"\n}\n\nã€è¨˜äº‹æ§‹æˆã€‘\n1. ## å°å…¥ï¼ˆèª­è€…ã®æ‚©ã¿ã€ã“ã®è¨˜äº‹ã§åˆ†ã‹ã‚‹ã“ã¨ï¼‰\n2. ## åŸºæœ¬ã®è€ƒãˆæ–¹ï¼ˆå‰æçŸ¥è­˜ï¼‰\n3. ## å…·ä½“çš„ãªã‚¹ãƒ†ãƒƒãƒ—ï¼ˆæ‰‹é †ã‚’æ˜ç¢ºã«ã€ç•ªå·ä»˜ããƒªã‚¹ãƒˆä½¿ç”¨ï¼‰\n4. ## æ³¨æ„ç‚¹ãƒ»ã‚ˆãã‚ã‚‹å¤±æ•—\n5. ## ã¾ã¨ã‚ï¼ˆè¦ç‚¹ã¨æœ€åˆã®ä¸€æ­©ï¼‰\n\nã€æ–‡å­—æ•°ã€‘: 2000-3000æ–‡å­—\n\nã€ãƒ¬ãƒ™ãƒ«åˆ¥ã®æ›¸ãåˆ†ã‘ã€‘\n- åˆå¿ƒè€…å‘ã‘: ç”¨èªã‚’ä¸å¯§ã«èª¬æ˜ã€å°ã•ã„ã‚¹ãƒ†ãƒƒãƒ—ã€å„ªã—ã„è¨€è‘‰é£ã„\n- ä¸­ç´šè€…ä»¥ä¸Š: æ¯”è¼ƒãƒ»æˆ¦ç•¥ãƒ»åŠ¹ç‡åŒ–é‡è¦–ã€å…·ä½“çš„ãªæ•°å€¤\n- ä¸Šç´šè€…: æ·±æ˜ã‚Šã—ãŸåˆ†æã€é«˜åº¦ãªãƒ†ã‚¯ãƒ‹ãƒƒã‚¯\n- è¶…ãƒã‚¤æ´»ç‰¹åŒ–: ãƒãƒ‹ã‚¢ãƒƒã‚¯ã€æœ€æ–°æƒ…å ±ã€è£æŠ€\n\nã€ã‚¹ã‚¿ã‚¤ãƒ«ã€‘\n- èª­è€…ã«èªã‚Šã‹ã‘ã‚‹è¦ªã—ã¿ã‚„ã™ã„ãƒˆãƒ¼ãƒ³\n- å…·ä½“ä¾‹ã‚„æ•°å€¤ã‚’è±Šå¯Œã«ä½¿ç”¨\n- å®Ÿè·µçš„ã§å³è¡Œå‹•ã§ãã‚‹å†…å®¹\n- å°‚é–€ç”¨èªã¯ä¸å¯§ã«èª¬æ˜\n\nã€é‡è¦ã€‘\n- JSONå½¢å¼ã®ã¿å‡ºåŠ›ï¼ˆèª¬æ˜æ–‡ä¸è¦ï¼‰\n- æ—¥æœ¬èªã®ã¿\n- é•æ³•è¡Œç‚ºãƒ»è¦ç´„é•åã®å†…å®¹ã¯å«ã‚ãªã„\n- å…·ä½“çš„ãªæ•°å€¤ãƒ»äº‹ä¾‹ã‚’å«ã‚ã‚‹\n- èª­è€…ã®ç–‘å•ã‚’å…ˆå›ã‚Šã—ã¦è§£æ±º\n`.trim();\n\nconsole.log('ğŸ“ è¨˜äº‹ç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆå®Œäº†');\nconsole.log('ãƒ†ãƒ¼ãƒ:', theme);\nconsole.log('ãƒ¬ãƒ™ãƒ«:', level);\n\nreturn [{ json: { prompt, theme, level, themeNo: no, themeData: $json } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -600,
        240
      ],
      "id": "code-article-prompt-001",
      "name": "è¨˜äº‹ç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆ",
      "notes": "Gemini APIã«é€ä¿¡ã™ã‚‹è¨˜äº‹ç”Ÿæˆç”¨ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½œæˆ"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "messages": {
          "values": [
            {
              "content": "={{$json.prompt}}"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        -400,
        240
      ],
      "id": "gemini-article-generation-001",
      "name": "Geminiè¨˜äº‹ç”Ÿæˆ",
      "notes": "âœ… å‹•ä½œç¢ºèªæ¸ˆã¿: Gemini 2.5 Flash ã§è¨˜äº‹ã‚’ç”Ÿæˆ",
      "credentials": {
        "googlePalmApi": {
          "id": "gojn353h4HLDUzF2",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Gemini APIã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰JSONæŠ½å‡º\ntry {\n  const responseText = $json.content?.parts?.[0]?.text || $json.text || '';\n  \n  console.log('ğŸ” Geminiãƒ¬ã‚¹ãƒãƒ³ã‚¹å—ä¿¡:', responseText.substring(0, 200) + '...');\n  \n  // JSONãƒ–ãƒ­ãƒƒã‚¯ã‚’æŠ½å‡ºï¼ˆè¤‡æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³å¯¾å¿œï¼‰\n  let jsonText = responseText;\n  \n  // ãƒ‘ã‚¿ãƒ¼ãƒ³1: ```json```ã§å›²ã¾ã‚Œã¦ã„ã‚‹\n  let jsonMatch = responseText.match(/```json\\s*([\\s\\S]*?)```/);\n  if (jsonMatch) {\n    jsonText = jsonMatch[1];\n    console.log('âœ… ```json```ãƒ–ãƒ­ãƒƒã‚¯ã‚’æ¤œå‡º');\n  } else {\n    // ãƒ‘ã‚¿ãƒ¼ãƒ³2: ```ã®ã¿ã§å›²ã¾ã‚Œã¦ã„ã‚‹\n    jsonMatch = responseText.match(/```\\s*([\\s\\S]*?)```/);\n    if (jsonMatch) {\n      jsonText = jsonMatch[1];\n      console.log('âœ… ```ãƒ–ãƒ­ãƒƒã‚¯ã‚’æ¤œå‡º');\n    }\n  }\n  \n  // å‰å¾Œã®ç©ºç™½ã‚’å‰Šé™¤\n  jsonText = jsonText.trim();\n  \n  // JSONã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®é–‹å§‹ä½ç½®ã‚’æ¢ã™\n  const startIndex = jsonText.indexOf('{');\n  const endIndex = jsonText.lastIndexOf('}');\n  if (startIndex !== -1 && endIndex !== -1) {\n    jsonText = jsonText.substring(startIndex, endIndex + 1);\n  }\n  \n  const articleData = JSON.parse(jsonText);\n  \n  // å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ç¢ºèª\n  if (!articleData.title || !articleData.content_markdown) {\n    throw new Error('å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆtitle, content_markdownï¼‰ãŒã‚ã‚Šã¾ã›ã‚“');\n  }\n  \n  console.log('âœ… è¨˜äº‹ç”ŸæˆæˆåŠŸ:', articleData.title);\n  console.log('ğŸ“Š æ–‡å­—æ•°:', articleData.content_markdown.length);\n  \n  // å‰ã®ãƒãƒ¼ãƒ‰ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒ\n  const promptNode = $('è¨˜äº‹ç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆ').item.json;\n  \n  return [{ \n    json: { \n      ...articleData,\n      theme: promptNode.theme,\n      level: promptNode.level,\n      themeNo: promptNode.themeNo,\n      themeData: promptNode.themeData\n    } \n  }];\n} catch (err) {\n  console.error('âŒ è¨˜äº‹JSONè§£æã‚¨ãƒ©ãƒ¼:', err.message);\n  console.error('ç”Ÿã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹:', JSON.stringify($json, null, 2).substring(0, 500));\n  throw new Error('è¨˜äº‹JSONã®è§£æã«å¤±æ•—ã—ã¾ã—ãŸ: ' + err.message);\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -200,
        240
      ],
      "id": "code-parse-article-001",
      "name": "è¨˜äº‹JSONè§£æ",
      "notes": "Geminiã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºãƒ»è§£æ"
    },
    {
      "parameters": {
        "jsCode": "const theme = $json.theme;\nconst level = $json.level;\nconst title = $json.title;\n\n// æ—¥æœ¬èªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ç”»åƒç”Ÿæˆï¼ˆGemini Imagenå¯¾å¿œï¼‰\nconst imagePrompt = `\n${theme}ã«é–¢ã™ã‚‹ã€æ—¥æœ¬ã®ãƒã‚¤æ´»ãƒ»ç¯€ç´„è¨˜äº‹ã®ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚\n\nã€ã‚¹ã‚¿ã‚¤ãƒ«ã€‘\n- ãƒ¢ãƒ€ãƒ³ã§ãƒ•ãƒ©ãƒƒãƒˆãªã‚¤ãƒ©ã‚¹ãƒˆã‚¹ã‚¿ã‚¤ãƒ«\n- è¦ªã—ã¿ã‚„ã™ãã€æ˜ã‚‹ã„é›°å›²æ°—\n- ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ: ã‚ªãƒ¬ãƒ³ã‚¸ï¼ˆ#f97316ï¼‰ã€ãƒ™ãƒ¼ã‚¸ãƒ¥ï¼ˆ#fef3e2ï¼‰ã€ãƒ–ãƒ«ãƒ¼ã€ã‚°ãƒªãƒ¼ãƒ³ã‚’åŸºèª¿\n- æ¨ªé•·ï¼ˆ16:9ï¼‰ã€èƒŒæ™¯ã¯ã‚·ãƒ³ãƒ—ãƒ«ãªã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³\n\nã€å«ã‚ã‚‹è¦ç´ ã€‘\n- ãƒã‚¤ãƒ³ãƒˆã‚«ãƒ¼ãƒ‰ã€ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã€ã‚³ã‚¤ãƒ³ã€çŸ¢å°ã€ã‚¢ã‚¤ã‚³ãƒ³\n- æ—¥æœ¬ã‚‰ã—ã„ãƒ‡ã‚¶ã‚¤ãƒ³è¦ç´ ï¼ˆå’Œé¢¨ã®è£…é£¾ã‚„é…è‰²ï¼‰\n- ${level === 'åˆå¿ƒè€…å‘ã‘' ? 'åˆå¿ƒè€…ã«ã‚‚åˆ†ã‹ã‚Šã‚„ã™ã„ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹æˆ' : 'ã‚„ã‚„è©³ç´°ã§æ´—ç·´ã•ã‚ŒãŸæ§‹æˆ'}\n\nã€é‡è¦ã€‘\n- ç”»åƒå†…ã«ãƒ†ã‚­ã‚¹ãƒˆã¯ä¸è¦\n- ã‚¯ãƒªãƒ¼ãƒ³ã§è¦‹ã‚„ã™ã„ãƒ‡ã‚¶ã‚¤ãƒ³\n- Webã‚µãƒ ãƒã‚¤ãƒ«ã¨ã—ã¦æœ€é©åŒ–\n- æ˜ã‚‹ãå‰å‘ããªå°è±¡\n`.trim();\n\nconsole.log('ğŸ¨ ç”»åƒç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆå®Œäº†');\nconsole.log('ãƒ†ãƒ¼ãƒ:', theme);\n\nreturn [{ json: { ...$json, imagePrompt } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        0,
        240
      ],
      "id": "code-image-prompt-001",
      "name": "ç”»åƒç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆ",
      "notes": "Gemini Imagenç”¨ã®ç”»åƒç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½œæˆï¼ˆæ—¥æœ¬èªå¯¾å¿œï¼‰"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/nano-banana-pro-preview",
          "mode": "list",
          "cachedResultName": "models/nano-banana-pro-preview"
        },
        "messages": {
          "values": [
            {
              "content": "={{$json.imagePrompt}}"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        200,
        240
      ],
      "id": "gemini-image-generation-001",
      "name": "Geminiç”»åƒç”Ÿæˆï¼ˆNano Bananaï¼‰",
      "notes": "âš ï¸ ãƒ†ã‚¹ãƒˆè¦: Nano Banana Pro ã§ç”»åƒç”Ÿæˆã‚’è©¦ã™ã€‚ã†ã¾ãã„ã‹ãªã„å ´åˆã¯ä¸‹ã®HTTPãƒãƒ¼ãƒ‰ã‚’ä½¿ç”¨",
      "credentials": {
        "googlePalmApi": {
          "id": "gojn353h4HLDUzF2",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-001:predict",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ {\n  \"instances\": [{\n    \"prompt\": $json.imagePrompt\n  }],\n  \"parameters\": {\n    \"sampleCount\": 1,\n    \"aspectRatio\": \"16:9\",\n    \"safetySetting\": \"block_some\",\n    \"personGeneration\": \"allow_adult\"\n  }\n} }}",
        "options": {
          "response": {
            "response": {
              "fullResponse": false,
              "responseFormat": "json"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        200,
        400
      ],
      "id": "http-gemini-image-001",
      "name": "Geminiç”»åƒç”Ÿæˆï¼ˆHTTPä»£æ›¿ï¼‰",
      "notes": "âš ï¸ ä»£æ›¿æ¡ˆ: Nano Banana ProãŒã†ã¾ãã„ã‹ãªã„å ´åˆã¯ã“ã¡ã‚‰ã‚’ä½¿ç”¨ã€‚Gemini Header Authèªè¨¼ãŒå¿…è¦",
      "credentials": {
        "httpHeaderAuth": {
          "id": "PLEASE_CREATE_GEMINI_HEADER_AUTH",
          "name": "Gemini Header Auth"
        }
      }
    },
    {
      "parameters": {
        "mode": "jsonToBinary",
        "convertAllData": false,
        "sourceProperty": "predictions[0].bytesBase64Encoded",
        "options": {
          "fileName": "=col-{{$json.themeNo}}-{{Date.now()}}.png",
          "mimeType": "image/png"
        }
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        400,
        240
      ],
      "id": "convert-to-file-001",
      "name": "Base64â†’ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›",
      "notes": "â€» ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ§‹é€ ã«å¿œã˜ã¦ã€sourcePropertyã‚’èª¿æ•´ã—ã¦ãã ã•ã„"
    },
    {
      "parameters": {
        "mode": "binaryToJson",
        "binaryPropertyName": "data",
        "jsonPropertyName": "data",
        "options": {
          "encoding": "base64",
          "keepSource": true
        }
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        600,
        240
      ],
      "id": "extract-from-file-001",
      "name": "ãƒ•ã‚¡ã‚¤ãƒ«â†’Base64å¤‰æ›",
      "notes": "TokuSearch Upload APIã«Base64å½¢å¼ã§é€ä¿¡ã™ã‚‹ãŸã‚å¤‰æ›"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://tokusearch.vercel.app/api/admin/columns/upload-image",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ {\n  \"image\": $json.data,\n  \"filename\": $binary.data.fileName\n} }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        800,
        240
      ],
      "id": "http-upload-image-001",
      "name": "ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰",
      "notes": "âš ï¸ è¦è¨­å®š: N8N API Key Authèªè¨¼æƒ…å ±ã‚’ä½œæˆã—ã¦ãã ã•ã„ï¼ˆHeader Name: x-api-keyï¼‰",
      "credentials": {
        "httpHeaderAuth": {
          "id": "PLEASE_CREATE_N8N_API_KEY_AUTH",
          "name": "N8N API Key Auth"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Markdownã®å†…å®¹ã¯ãã®ã¾ã¾ä¿æŒï¼ˆAPIå´ã§HTMLå¤‰æ›ã‚’è¡Œã†ï¼‰\nconst articleData = $('è¨˜äº‹JSONè§£æ').item.json;\nconst thumbnailUrl = $json.url;\n\nconsole.log('ğŸ“¤ æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿æº–å‚™:', articleData.title);\nconsole.log('ğŸ–¼ï¸ ã‚µãƒ ãƒã‚¤ãƒ«URL:', thumbnailUrl);\n\nreturn [{ \n  json: {\n    title: articleData.title,\n    slug: '', // è‡ªå‹•ç”Ÿæˆ\n    description: articleData.description,\n    content_markdown: articleData.content_markdown,\n    category: articleData.category,\n    tags: articleData.tags,\n    thumbnail_url: thumbnailUrl,\n    author: 'TokuSearchç·¨é›†éƒ¨',\n    status: 'published',\n    // Google Sheetsæ›´æ–°ç”¨\n    themeNo: articleData.themeNo,\n    themeData: articleData.themeData,\n    theme: articleData.theme\n  } \n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1000,
        240
      ],
      "id": "code-prepare-post-001",
      "name": "æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿æº–å‚™",
      "notes": "TokuSearch APIç”¨ã«æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿ã‚’æ•´å½¢"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://tokusearch.vercel.app/api/admin/columns",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ {\n  \"title\": $json.title,\n  \"slug\": $json.slug,\n  \"description\": $json.description,\n  \"content_markdown\": $json.content_markdown,\n  \"category\": $json.category,\n  \"tags\": $json.tags,\n  \"thumbnail_url\": $json.thumbnail_url,\n  \"author\": $json.author,\n  \"status\": $json.status\n} }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1200,
        240
      ],
      "id": "http-post-column-001",
      "name": "ã‚³ãƒ©ãƒ æŠ•ç¨¿",
      "notes": "âš ï¸ è¦è¨­å®š: N8N API Key Authèªè¨¼æƒ…å ±ã‚’ä½¿ç”¨ï¼ˆç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã¨åŒã˜ï¼‰",
      "credentials": {
        "httpHeaderAuth": {
          "id": "PLEASE_CREATE_N8N_API_KEY_AUTH",
          "name": "N8N API Key Auth"
        }
      }
    },
    {
      "parameters": {
        "authentication": "serviceAccount",
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1iz1ApPwoLMMyqeQW_GA0XYM1qU74tzULNVq6vav3g14",
          "mode": "list",
          "cachedResultName": "TokuSearch",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1iz1ApPwoLMMyqeQW_GA0XYM1qU74tzULNVq6vav3g14/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "column_themes",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "used": "=TRUE",
            "used_at": "={{new Date().toISOString()}}"
          }
        },
        "options": {
          "lookupColumn": "no",
          "lookupValue": "={{$('æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿æº–å‚™').item.json.themeNo}}"
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1400,
        240
      ],
      "id": "google-sheets-update-001",
      "name": "ãƒ†ãƒ¼ãƒä½¿ç”¨æ¸ˆã¿æ›´æ–°",
      "notes": "column_themesã‚·ãƒ¼ãƒˆã®usedã‚’TRUEã€used_atã«ç¾åœ¨æ—¥æ™‚ã‚’è¨­å®š",
      "credentials": {
        "googleApi": {
          "id": "r9kAyVencycJeNjy",
          "name": "Google Service Account account 2"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const article = $('æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿æº–å‚™').item.json;\nconst columnResponse = $('ã‚³ãƒ©ãƒ æŠ•ç¨¿').item.json;\n\nconst message = `âœ… ã‚³ãƒ©ãƒ è‡ªå‹•æŠ•ç¨¿å®Œäº†ï¼\n\nğŸ“ ã‚¿ã‚¤ãƒˆãƒ«: ${article.title}\nğŸ·ï¸ ã‚«ãƒ†ã‚´ãƒª: ${article.category}\nğŸ”– ã‚¿ã‚°: ${article.tags}\nğŸ“Š ãƒ†ãƒ¼ãƒNo: ${article.themeNo}\nğŸŒ ãƒ†ãƒ¼ãƒ: ${article.theme}\nğŸ“ˆ ãƒ¬ãƒ™ãƒ«: ${article.themeData?.level || 'ä¸æ˜'}\n\n${columnResponse.slug ? 'ğŸ”— URL: https://tokusearch.vercel.app/columns/' + columnResponse.slug : ''}\n\nğŸ‰ è¨˜äº‹ãŒæ­£å¸¸ã«æŠ•ç¨¿ã•ã‚Œã¾ã—ãŸï¼`;\n\nconsole.log(message);\n\nreturn [{ json: { message, article, response: columnResponse } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1600,
        240
      ],
      "id": "code-notification-001",
      "name": "å®Œäº†é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä½œæˆ",
      "notes": "Slacké€šçŸ¥ç”¨ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œæˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³: Slackãƒãƒ¼ãƒ‰ã‚’è¿½åŠ å¯èƒ½ï¼‰"
    }
  ],
  "connections": {
    "æ¯æ—¥9æ™‚ãƒˆãƒªã‚¬ãƒ¼": {
      "main": [
        [
          {
            "node": "æœªä½¿ç”¨ãƒ†ãƒ¼ãƒå–å¾—",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æœªä½¿ç”¨ãƒ†ãƒ¼ãƒå–å¾—": {
      "main": [
        [
          {
            "node": "ãƒ©ãƒ³ãƒ€ãƒ ãƒ†ãƒ¼ãƒé¸æŠ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ãƒ©ãƒ³ãƒ€ãƒ ãƒ†ãƒ¼ãƒé¸æŠ": {
      "main": [
        [
          {
            "node": "è¨˜äº‹ç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¨˜äº‹ç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆ": {
      "main": [
        [
          {
            "node": "Geminiè¨˜äº‹ç”Ÿæˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Geminiè¨˜äº‹ç”Ÿæˆ": {
      "main": [
        [
          {
            "node": "è¨˜äº‹JSONè§£æ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¨˜äº‹JSONè§£æ": {
      "main": [
        [
          {
            "node": "ç”»åƒç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç”»åƒç”Ÿæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½œæˆ": {
      "main": [
        [
          {
            "node": "Geminiç”»åƒç”Ÿæˆï¼ˆNano Bananaï¼‰",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Geminiç”»åƒç”Ÿæˆï¼ˆNano Bananaï¼‰": {
      "main": [
        [
          {
            "node": "Base64â†’ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Base64â†’ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›": {
      "main": [
        [
          {
            "node": "ãƒ•ã‚¡ã‚¤ãƒ«â†’Base64å¤‰æ›",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ãƒ•ã‚¡ã‚¤ãƒ«â†’Base64å¤‰æ›": {
      "main": [
        [
          {
            "node": "ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰": {
      "main": [
        [
          {
            "node": "æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿æº–å‚™",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿æº–å‚™": {
      "main": [
        [
          {
            "node": "ã‚³ãƒ©ãƒ æŠ•ç¨¿",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ã‚³ãƒ©ãƒ æŠ•ç¨¿": {
      "main": [
        [
          {
            "node": "ãƒ†ãƒ¼ãƒä½¿ç”¨æ¸ˆã¿æ›´æ–°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ãƒ†ãƒ¼ãƒä½¿ç”¨æ¸ˆã¿æ›´æ–°": {
      "main": [
        [
          {
            "node": "å®Œäº†é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä½œæˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2025-11-27T00:00:00.000Z",
  "versionId": "2.0.0",
  "meta": {
    "instanceId": "fefffd21e64fa94994bb4bf38b5a050c59f6cf28bd3cad9da0a5804220d9e97f"
  }
}



